{% extends "base.html" %}
{% block header %}
<img style="text-align: center; float: left; margin-right: 20px;" class="{% if ustat.online() %} online {% endif %}img-polaroid" src="https://minotar.net/avatar/{{ user.username }}/60">
<h2 style="margin: 0px 0px; float: right;"><i>{% if user.tag_line %}"{{ user.tag_line }}"{% endif %}</i></h2>
  <h1>{{user.username}}</h1> 
  
  <h3 style="margin: 0px 0px;">
    {% if ustat.online() %}
      <i>Online: {{ ustat.getServer() }}</i>
    {% else %}
      <i>Last played: {{ user.last_join|pretty }}</i>
    {% endif %}
  </h2>
{% endblock %}
{% block content %}
<div class="row-fluid">
  <article class="span8 data-block">
  <div class="data-container">
    <header>
      <h2>About {{ user.username }}</h2>
      <ul class="data-header-actions">
        {% if user.level <= 20 %}
        <li><span class="label">Regular</span></li>
        {% elif user.level == 30 %} 
        <li><span class="label label-success">Donator</span></li>
        {% elif user.level == 40 %}
        <li><span class="label label-info">Community Contributor</span></li>
        {% elif user.level == 45 %}
        <li><span class="label label-info">Map Developer</span></li>
        {% elif user.level == 50 %}
        <li><span class="label label-warning">Junior Moderator</span></li>
        {% elif user.level == 60 %}
        <li><span class="label label-warning">Moderator</span></li>
        {% elif user.level == 70 %}
        <li><span class="label label-important">Developer</span></li>
        {% elif user.level == 80 %}
        <li><span class="label label-important">Admin</span></li>
        {% elif user.level >= 90 %}
        <li><span class="label label-inverse">Creator</span></li>
        {% endif %}
        {% if g.user and g.user.isFriendsWith(user) %}
          <li style="margin-left: 10px;"><span class="label label-success friend">Friend</span></li>
        {% endif %}
      </ul>
    </header>
    <section>

      <b>Description:</b> <div class="well"><p>{{ user.description|safe }}</p></div>
      <b>Gender:</b><p>{{ user.gender }}</p>
      {% if user.location != "None" %}<b>Location:</b><p>{{ user.location }}</p>{% endif %}
      {% if user.youtube != "None" %}<b>Youtube:</b><p>{{ user.youtube }}</p>{% endif %}
      {% if user.twitch != "None" %}<b>Twitch:</b><p>{{ user.Twitch }}</p>{% endif %}
      {% if user.twitter != "None" %}<b>Twitter:</b><p>{{ user.twitter }}</p>{% endif %}
      {% if user.skype != "None" %}<b>Skype:</b><p>{{ user.skype }}</p>{% endif %}
    </section>
    <hr>
    <footer>
      {% if g.user and g.user != user%}
        {% if g.user.canFriend(user) %}
          <a href="/acct/friend/{{ user.username }}/add" class="btn btn-success">
            <i class="icon-plus"></i> Add Friend
          </a>
        {% elif g.user.isFriendsWith(user) %}
          <a href="/acct/friend/{{ user.username }}/rmv" class="btn btn-danger">
            <i class="icon-minus"></i> Remove Friend
          </a>
        {% endif %}
        {% if g.user.level >= 60 %}
          <a href="/admin/user/{{ user.username }}/" class="btn btn-success">
            <i class="icon-pencil"></i> Edit User
          </a>
        {% endif %}
      {% elif g.user %}
        <a href="/acct" class="btn btn-success">
          <i class="icon-pencil"></i> Edit Profile
        </a>
      {% endif %}
    </footer>
  </div>
</article>
<article class="span4 data-block data-block-alt">
    <div class="data-container">
      <section>
        <h3>PvP</h5>
        <div id="kdchartpvp" style="height: 200px; width: 200px; margin-bottom: 25px;"></div>
        <h5>PvP Stats</h5>
        <ul class="unstyled">
          <li class="push"><span class="icon-arrow-right"></span><b>K/D:</b> {{ ustat.kd() }}</li>
          <li class="push"><span class="icon-arrow-right"></span><b>Kills:</b> {{ ustat.kills() }}</li>
          <li class="push"><span class="icon-arrow-right"></span><b>Deaths:</b> {{ ustat.deaths() }}</li>
        </ul>
        <h3>PvE</h5>
        <div id="kdchartpve" style="height: 200px; width: 200px; margin-bottom: 25px;"></div>
        <h5>PvE Stats</h5>
        <ul class="unstyled">
          <li class="push"><span class="icon-arrow-right"></span><b>K/D:</b> {{ ustat.kd() }}</li>
          <li class="push"><span class="icon-arrow-right"></span><b>Kills:</b> {{ ustat.kills() }}</li>
          <li class="push"><span class="icon-arrow-right"></span><b>Deaths:</b> {{ ustat.deaths() }}</li>
        </ul>
      </section>
    </div>
  </article>
</div>
<div class="row-fluid">
  <article class="span6 data-block data-block-alt"></article>
</div>
{% endblock %}

{% block scripts %}
<script>
      $(document).ready(function() {
        options = {
            series: {
              pie: {
                show: true,
                radius: 1,
                label: {
                    show: true,
                    radius: 2/4,
                    formatter: function(label, series){
                        return '<div style="font-size:8pt;text-align:center;padding:2px;color:white;">'+label+'<br/>'+Math.round(series.percent)+'%</div>';
                    },
                    threshold: 0.1,
                    background: { 
                        opacity: 0.7,
                        color: '#000'
                    }
                }
              }
            },
        legend: {
            show: false
        }    
      }
      var p = $.plot($("#kdchartpvp"), {{ ustat.kdchart("pvp")|safe }}, options);
      var p = $.plot($("#kdchartpve"), {{ ustat.kdchart("pve")|safe }}, options);
    });
  </script>
{% endblock %}